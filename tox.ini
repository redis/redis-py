[pytest]
addopts = -s

[tox]
minversion = 2.4
envlist = py38-hiredis2

[testenv]
pip_pre = true
deps =
    coverage
    pytest >= 2.7.0
extras =
    hiredis: hiredis
    hiredis2: hiredis == 2.0.0.dev0
commands =
    {envpython} -b -m coverage run -p -m pytest -W always {posargs}
    {envpython} -b -m coverage combine --append

[testenv:flake8]
basepython = python3.6
deps = flake8
commands = flake8
skipsdist = true
skip_install = true

[testenv:pypy3-plain]
basepython = pypy3

[testenv:pypy3-hiredis]
basepython = pypy3

[testenv:pypy3-hiredis2]
basepython = pypy3

[testenv:codecov]
deps = codecov
commands = codecov
passenv =
  REDIS_*
  CI
  CI_*
  CODECOV_*
  SHIPPABLE
  TRAVIS
  TRAVIS_*
  VCS_*

[testenv:covreport]
deps = coverage
commands = coverage report
